{"version":3,"file":"459c1fe7.js","sources":["../../../src/components/account/AccountCreateForm.client.tsx"],"sourcesContent":["import {useState} from 'react';\nimport {useNavigate, Link} from '@shopify/hydrogen/client';\n\nimport {emailValidation, passwordValidation} from '~/lib/utils';\n\nimport {callLoginApi} from './AccountLoginForm.client';\n\ninterface FormElements {\n  email: HTMLInputElement;\n  password: HTMLInputElement;\n}\n\nexport function AccountCreateForm() {\n  const navigate = useNavigate();\n\n  const [submitError, setSubmitError] = useState<null | string>(null);\n  const [email, setEmail] = useState('');\n  const [emailError, setEmailError] = useState<null | string>(null);\n  const [password, setPassword] = useState('');\n  const [passwordError, setPasswordError] = useState<null | string>(null);\n\n  async function onSubmit(\n    event: React.FormEvent<HTMLFormElement & FormElements>,\n  ) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setPasswordError(null);\n    setSubmitError(null);\n\n    const newEmailError = emailValidation(event.currentTarget.email);\n    if (newEmailError) {\n      setEmailError(newEmailError);\n    }\n\n    const newPasswordError = passwordValidation(event.currentTarget.password);\n    if (newPasswordError) {\n      setPasswordError(newPasswordError);\n    }\n\n    if (newEmailError || newPasswordError) {\n      return;\n    }\n\n    const accountCreateResponse = await callAccountCreateApi({\n      email,\n      password,\n    });\n\n    if (accountCreateResponse.error) {\n      setSubmitError(accountCreateResponse.error);\n      return;\n    }\n\n    // this can be avoided if customerCreate mutation returns customerAccessToken\n    await callLoginApi({\n      email,\n      password,\n    });\n\n    navigate('/account');\n  }\n\n  return (\n    <div className=\"flex justify-center my-24 px-4\">\n      <div className=\"max-w-md w-full\">\n        <h1 className=\"text-4xl font-thin\">Create an account</h1>\n        <form noValidate className=\"pt-6 pb-8 mt-4 mb-4\" onSubmit={onSubmit}>\n          {submitError && (\n            <div className=\"flex items-center justify-center mb-6 bg-zinc-500\">\n              <p className=\"m-4 text-s text-contrast\">{submitError}</p>\n            </div>\n          )}\n          <div className=\"mb-3\">\n            <input\n              className={`mb-1 appearance-none rounded border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline ${\n                emailError ? ' border-[#14394f]' : 'border-gray-900'\n              }`}\n              id=\"email\"\n              name=\"email\"\n              type=\"email\"\n              autoComplete=\"email\"\n              required\n              placeholder=\"Email address\"\n              aria-label=\"Email address\"\n              // eslint-disable-next-line jsx-a11y/no-autofocus\n              autoFocus\n              value={email}\n              onChange={(event) => {\n                setEmail(event.target.value);\n              }}\n            />\n            {!emailError ? (\n              ''\n            ) : (\n              <p className={`text-[#14394f] text-xs`}>{emailError} &nbsp;</p>\n            )}\n          </div>\n          <div className=\"mb-3\">\n            <input\n              className={`mb-1 appearance-none rounded border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline ${\n                passwordError ? ' border-[#14394f]' : 'border-gray-900'\n              }`}\n              id=\"password\"\n              name=\"password\"\n              type=\"password\"\n              autoComplete=\"current-password\"\n              placeholder=\"Password\"\n              aria-label=\"Password\"\n              value={password}\n              minLength={8}\n              required\n              onChange={(event) => {\n                setPassword(event.target.value);\n              }}\n            />\n            {!passwordError ? (\n              ''\n            ) : (\n              <p className={`text-[#14394f] text-xs`}>{passwordError} &nbsp;</p>\n            )}\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <button\n              className=\"bg-[#14394f] text-contrast rounded py-2 px-4 focus:shadow-outline block w-full\"\n              type=\"submit\"\n            >\n              Create Account\n            </button>\n          </div>\n          <div className=\"flex items-center mt-4\">\n            <p className=\"align-baseline text-sm\">\n              Already have an account? &nbsp;\n              <Link className=\"inline underline text-[#14394f]\" to=\"/account\">\n                Sign in\n              </Link>\n            </p>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport async function callAccountCreateApi({\n  email,\n  password,\n  firstName,\n  lastName,\n}: {\n  email: string;\n  password: string;\n  firstName?: string;\n  lastName?: string;\n}) {\n  try {\n    const res = await fetch(`/account/register`, {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({email, password, firstName, lastName}),\n    });\n    if (res.status === 200) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (error: any) {\n    return {\n      error: error.toString(),\n    };\n  }\n}\n"],"names":["navigate","useNavigate","submitError","setSubmitError","useState","email","setEmail","emailError","setEmailError","password","setPassword","passwordError","setPasswordError","event","preventDefault","newEmailError","emailValidation","currentTarget","newPasswordError","passwordValidation","accountCreateResponse","callAccountCreateApi","error","callLoginApi","_jsx","_jsxs","target","value","firstName","lastName","res","fetch","method","headers","Accept","body","JSON","stringify","status","json","toString"],"mappings":"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"}